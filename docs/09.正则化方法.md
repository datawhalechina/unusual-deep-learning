1. æ­£åˆ™åŒ–æ–¹æ³•æ¦‚è¿°
2. å‚æ•°èŒƒæ•°æ­£åˆ™åŒ–



# æ­£åˆ™åŒ–æ–¹æ³•æ¦‚è¿°

### æ•°æ®é›†

è®­ç»ƒé›†(Trainingset)ï¼šç”¨äºæ¨¡å‹æ‹Ÿåˆçš„æ•°æ®æ ·æœ¬ï¼›

éªŒè¯é›†(Validation set)ï¼šæ˜¯æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­å•ç‹¬ç•™å‡ºçš„æ ·æœ¬é›†ï¼Œå®ƒå¯ä»¥ç”¨äºè°ƒæ•´æ¨¡å‹çš„è¶…å‚æ•°å’Œç”¨äºå¯¹æ¨¡å‹çš„èƒ½åŠ›è¿›è¡Œåˆæ­¥è¯„ä¼°ï¼Œä¾‹å¦‚SVMä¸­å‚æ•°cå’Œæ ¸å‡½æ•°çš„é€‰æ‹©ï¼Œæˆ–è€…é€‰æ‹©ç½‘ç»œç»“æ„ï¼›

æµ‹è¯•é›†(Testset)ï¼šç”¨æ¥è¯„ä¼°æ¨¡æœ€ç»ˆæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œä½†ä¸èƒ½ä½œä¸ºè°ƒå‚ã€é€‰æ‹©ç‰¹å¾ç­‰ç®—æ³•ç›¸å…³çš„é€‰æ‹©çš„ä¾æ®ã€‚

### è¿‡æ‹Ÿåˆ

è¿‡æ‹Ÿåˆæ˜¯æŒ‡æ¨¡å‹èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒæ ·æœ¬ï¼Œè€Œæ— æ³•å¾ˆå¥½åœ°æ‹Ÿåˆæµ‹è¯•æ ·æœ¬çš„ç°è±¡ï¼Œä»è€Œå¯¼è‡´æ³›åŒ–æ€§èƒ½ä¸‹é™ï¼›ä¸ºé˜²æ­¢â€œè¿‡æ‹Ÿåˆâ€ï¼Œå¯ä»¥é€‰æ‹©å‡å°‘å‚æ•°ã€é™ä½æ¨¡å‹å¤æ‚åº¦ã€æ­£åˆ™åŒ–ç­‰ã€‚

### æ¬ æ‹Ÿåˆ

æ¬ æ‹Ÿåˆæ˜¯æŒ‡æ¨¡å‹è¿˜æ²¡æœ‰å¾ˆå¥½åœ°è®­ç»ƒå‡ºæ•°æ®çš„ä¸€èˆ¬è§„å¾‹ï¼Œæ¨¡å‹æ‹Ÿåˆç¨‹åº¦ä¸é«˜

çš„ç°è±¡ï¼›ä¸ºé˜²æ­¢â€œæ¬ æ‹Ÿåˆâ€ï¼Œå¯ä»¥é€‰æ‹©è°ƒæ•´å‚æ•°ã€å¢åŠ è¿­ä»£æ·±åº¦ã€æ¢ç”¨æ›´åŠ 

å¤æ‚çš„æ¨¡å‹ç­‰ã€‚

<img src="./PIC/8/8.2.png" alt="8.2" style="zoom:50%;" />

### è¯¯å·®åˆ†æ

**åå·®(bias)**ï¼šåæ˜ äº†æ¨¡å‹åœ¨æ ·æœ¬ä¸Šçš„æœŸæœ›è¾“å‡ºä¸çœŸå®æ ‡è®°ä¹‹é—´çš„å·®è·ï¼Œå³æ¨¡å‹æœ¬èº«çš„ç²¾å‡†åº¦ï¼Œåæ˜ çš„æ˜¯æ¨¡å‹æœ¬èº«çš„æ‹Ÿåˆèƒ½åŠ›ã€‚

<img src="./PIC/8/8.3.png" alt="8.3" style="zoom:33%;" />

**æ–¹å·®(variance)**ï¼šåæ˜ äº†æ¨¡å‹åœ¨ä¸åŒè®­ç»ƒæ•°æ®é›†ä¸‹å­¦å¾—çš„å‡½æ•°çš„è¾“å‡ºä¸æœŸæœ›è¾“å‡ºä¹‹é—´çš„è¯¯å·®ï¼Œå³æ¨¡å‹çš„ç¨³å®šæ€§ï¼Œååº”çš„æ˜¯æ¨¡å‹çš„æ³¢åŠ¨æƒ…å†µã€‚

<img src="./PIC/8/8.4.png" alt="8.4" style="zoom:33%;" />

**æ³›åŒ–è¯¯å·®(Generalization Error)**ï¼šåº¦é‡è®­ç»ƒæ‰€å¾—æ¨¡å‹åœ¨æ€»ä½“æ•°æ®ä¸Šå¾—åˆ°çš„é¢„ä¼°å€¼å’Œæ ‡ç­¾å€¼åç¦»ç¨‹åº¦çš„æœŸæœ›ã€‚

<img src="./PIC/8/8.5.png" alt="8.5" style="zoom:33%;" />

**ä¸¾ä¾‹è¯´æ˜**

<img src="./PIC/8/8.6.png" alt="8.6" style="zoom:50%;" />

**æ·±åº¦å­¦ä¹ ä¸€èˆ¬æ­¥éª¤**

<img src="./PIC/8/8.7.png" alt="8.7" style="zoom:50%;" />

ä¸‹é¢æˆ‘ä»¬å¼•å‡ºæ­£åˆ™åŒ–çš„æ¦‚å¿µï¼Œé¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ä»€ä¹ˆæ˜¯ä¸€ä¸ªå¥½çš„æ¨¡å‹ï¼ŒåŸºæœ¬è¦æ±‚å°±æ˜¯åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å¥½ï¼Œä½†å¾€å¾€æˆ‘ä»¬ä¹Ÿå¸Œæœ›å®ƒèƒ½åœ¨å…¶ä»–æ•°æ®ä¸Šä¹Ÿæœ‰å¾ˆå¥½çš„è¡¨ç°ï¼Œä¹Ÿå°±æ˜¯æ³›åŒ–æ€§ã€‚

- å¹¿ä¹‰æ­£åˆ™åŒ–ï¼šé€šè¿‡æŸç§æ‰‹æ®µä½¿å­¦ä¹ ç®—æ³•åœ¨è®­ç»ƒè¯¯å·®å˜åŒ–ä¸å¤§çš„æƒ…å†µä¸‹ï¼Œä½¿å¾—æ³›åŒ–è¯¯å·®æ˜¾è‘—é™ä½çš„æ–¹æ³•
- ç‹­ä¹‰æ­£åˆ™åŒ–ï¼šä¸å‡å°‘ç½‘ç»œå‚æ•°ï¼Œåªè¿›è¡Œå‚æ•°èŒƒå›´è°ƒæ•´çš„æ–¹æ³•

# å‚æ•°èŒƒæ•°æ­£åˆ™åŒ–

### èŒƒæ•°åŸºæœ¬çŸ¥è¯†

æœºå™¨å­¦ä¹ ä¸­ï¼Œå¾ˆå¤šæ—¶å€™éƒ½éœ€è¦è¡¡é‡ä¸€ä¸ªå‘é‡çš„å¤§å°ï¼Œæ­¤æ—¶ä¾¿éœ€è¦ç”¨åˆ°èŒƒæ•°çš„çŸ¥è¯†ã€‚

èŒƒæ•°æ˜¯å°†å‘é‡æ˜ å°„åˆ°éè´Ÿå€¼çš„å‡½æ•°ï¼Œå®ƒæ»¡è¶³ä¸‰æ¡æ€§è´¨ï¼š

- éè´Ÿæ€§   $f(x) \geq 0(f(x)=0 \Leftrightarrow x=0)$
- é½æ¬¡æ€§   $\forall \alpha \in R, f(\alpha x)=|\alpha| f(x)$
- ä¸‰è§’ä¸ç­‰å¼   $f(x+y) \leq f(x)+f(y)$

$L_p$ èŒƒæ•°æ˜¯ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ä¸€ç§èŒƒæ•°ï¼Œå®šä¹‰ä¸º $\|\boldsymbol{x}\|_{\boldsymbol{p}}=(\sum_i |x_i|^p)^{1/p}$ï¼Œå½“ $p = 2$ æ—¶è¯¥èŒƒæ•°ç­‰ä»·äºå‘é‡å’ŒåŸç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»ã€‚æœ‰æ—¶å€™ä¹Ÿéœ€è¦è¡¡é‡çŸ©é˜µçš„å¤§å°ï¼Œåœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæœ€å¸¸è§çš„åšæ³•ä¾¿æ˜¯ä½¿ç”¨FrobeniusèŒƒæ•°(FèŒƒæ•°)ï¼Œå³ $\|\boldsymbol{x}\|_{\boldsymbol{F}} = \sqrt{\sum_{i, j} A_{i j}^{2}}$.

### å‚æ•°èŒƒæ•°æ­£åˆ™åŒ–

é€šè¿‡ç®€å•åœ°åœ¨æŸå¤±å‡½æ•° $J()$ åæ·»åŠ ä¸€ä¸ªå‚æ•°èŒƒæ•°æ­£åˆ™åŒ–é¡¹ $\Omega(\theta)$ï¼Œæ¥é™åˆ¶æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ï¼Œæ­£åˆ™åŒ–åçš„æŸå¤±å‡½æ•°å¯è¡¨ç¤ºä¸º $\tilde{J}$ï¼š
$$
\tilde{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})=\mathrm{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})+\alpha \Omega(\boldsymbol{\theta})
$$
å…¶ä¸­ï¼Œ$ \alpha $æ˜¯æ­£åˆ™é¡¹ç³»æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¶…å‚ï¼Œç”¨æ¥æƒè¡¡æƒ©ç½šé¡¹ $Î©$ å¯¹æŸå¤±å‡½æ•°çš„è´¡çŒ®ã€‚è‹¥ $Î±$ ä¸º0ï¼Œè¡¨ç¤ºæ— æ­£åˆ™åŒ–ï¼›$Î±$ è¶Šå¤§ï¼Œæ­£åˆ™åŒ–æƒ©ç½šè¶Šå¤§ã€‚

æˆ‘ä»¬å¸Œæœ›æ­£åˆ™åŒ–åçš„è®­ç»ƒè¯¯å·®ï¼ˆç¬¬ä¸€é¡¹ï¼‰æœ€å°ï¼Œåˆå¸Œæœ›æ¨¡å‹å°½é‡ç®€å•ï¼ˆç¬¬äºŒé¡¹ï¼‰ã€‚

å½“æœ€å°åŒ–æ­£åˆ™åŒ–åçš„æŸå¤±å‡½æ•°æ—¶å€™ï¼ŒåŒæ—¶é™ä½åŸæœ‰æŸå¤±å‡½æ•° $J()$å’Œæ­£åˆ™åŒ–é¡¹ $\Omega(\theta)$ çš„å€¼ï¼Œä¸€å®šç¨‹åº¦å‡å°‘äº†è¿‡æ‹Ÿåˆçš„ç¨‹åº¦ã€‚é€šä¿—æ¥è¯´ï¼Œæ­£åˆ™åŒ–å°±æ˜¯è®©å‚æ•°ï¼Œå¦‚æƒé‡wå¤šå‡ ä¸ªç­‰äº0ï¼Œæˆ– è€…æ¥è¿‘äº0ï¼Œè¯´æ˜è¯¥èŠ‚ç‚¹å½±å“å¾ˆå°ï¼Œå¦‚æœæ˜¯ç¥ç»ç½‘ç»œç›¸å½“äº åœ¨ç¥ç»ç½‘ç»œä¸­åˆ æ‰äº†ä¸€äº›èŠ‚ç‚¹ï¼Œè¿™æ ·æ¨¡å‹å°±å˜ç®€å•äº†ã€‚

- $L_0$ èŒƒæ•°ï¼š$\|\boldsymbol{W}\|_{\boldsymbol{0}}$ï¼ŒæŒ‡å‘é‡ä¸­é0çš„å…ƒç´ çš„ä¸ªæ•°ï¼Œè¶Šå°è¯´æ˜0å…ƒç´ è¶Šå¤š
- $L_1$ èŒƒæ•°ï¼š$\|\boldsymbol{W}\|_{\boldsymbol{1}}$ï¼ŒæŒ‡å‘é‡ä¸­å„ä¸ªå…ƒç´ ç»å¯¹å€¼ä¹‹å’Œ
- $L_2$ èŒƒæ•°ï¼š$\|\boldsymbol{W}\|_{\boldsymbol{2}}$ï¼Œå³å„å…ƒç´ çš„å¹³æ–¹å’Œå†å¼€æ–¹

### $L_2$ æ­£åˆ™åŒ– 

L2æ­£åˆ™åŒ–ä¸»è¦ç”¨äºçº¿æ€§å›å½’ï¼Œåˆç§°ä¸ºå²­å›å½’(Ridge Regression) æˆ–æƒé‡è¡°å‡(Weight decay)ï¼Œæ·»åŠ çš„æ­£åˆ™åŒ–é¡¹å½¢å¼å¦‚ä¸‹ï¼š
$$
\Omega(\mathbf{w})=\frac{1}{2}\|\mathbf{w}\|_{2}^{2}
$$
æŸå¤±å‡½æ•°ï¼š
$$
\tilde{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})=\mathrm{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})+ \frac{\alpha}{2}\|\mathbf{w}\|_{2}^{2}
$$
**L2å‚æ•°æ­£åˆ™åŒ–åˆ†æ(å•æ­¥)**

å¯¹äºæŸä¸€æ¨¡å‹ï¼Œå‡è®¾è¦å¯¹å…¶æ‰€æœ‰çš„å‚æ•°è¿›è¡Œå‚æ•°æ­£åˆ™åŒ–ï¼Œåˆ™æ­£åˆ™åŒ–åçš„æ•´ä½“æŸå¤±å‡½æ•° $\tilde{J}$ ä¸º $\tilde{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})=\mathrm{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})+ \frac{\alpha}{2}\|\mathbf{w}\|_{2}^{2}$.
è®¡ç®—æ¢¯åº¦å¾— $\nabla_{\mathbf{w}} \tilde{J}(\boldsymbol{w} ; \boldsymbol{X}, \boldsymbol{y})=\nabla_{\mathbf{w}} J(\boldsymbol{w} ; \boldsymbol{X}, \boldsymbol{y})+\alpha w$.

ä½¿ç”¨å•æ­¥æ¢¯åº¦ä¸‹é™æ›´æ–°æƒé‡ï¼š
$$
\begin{aligned} \mathbf{w} & \leftarrow \mathbf{w}-\lambda\left(\nabla_{\mathbf{w}} J(\boldsymbol{w} ; \boldsymbol{X}, \boldsymbol{y})+\alpha \boldsymbol{w}\right) \\ &=(1-\lambda \alpha) \mathbf{w}-\lambda \nabla_{\mathbf{w}} J(\boldsymbol{w} ; \boldsymbol{X}, \boldsymbol{y}) \end{aligned}
$$
åœ¨è¿›è¡Œæ¯æ­¥æ¢¯åº¦æ›´æ–°å‰ï¼Œå…ˆå¯¹å‚æ•° w è¿›è¡Œäº†ç¼©æ”¾ã€‚å› æ­¤ï¼Œè¿™ä¹Ÿæ˜¯æƒé‡è¡°å‡åç§°çš„æ¥æºã€‚

**L2å‚æ•°æ­£åˆ™åŒ–åˆ†æ(æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹)**

æˆ‘ä»¬å…ˆè®°æœªæ­£åˆ™åŒ–çš„æŸå¤±å‡½æ•° $ğ½$å¾—åˆ°çš„æœ€å°æŸå¤±æƒé‡å‘é‡ä¸º $\mathbf{w}^{*}=\operatorname{argmin}_{\boldsymbol{w}} J(\boldsymbol{w})$. åœ¨ $w^*$ é™„è¿‘å¯¹æŸå¤±å‡½æ•°åšäºŒæ¬¡è¿‘ä¼¼ï¼Œè¿‘ä¼¼çš„ $\tilde{J}(w)$ å¦‚ä¸‹ï¼š
$$
\hat{J}(\mathbf{w})=J\left(\mathbf{w}^{*}\right)+\left(\mathbf{w}-\mathbf{w}^{*}\right)^{T} \nabla J\left(\mathbf{w}^{*}\right)+\frac{1}{2}\left(\mathbf{w}-\mathbf{w}^{*}\right)^{T} \boldsymbol{H}\left(\mathbf{w}-\mathbf{w}^{*}\right)
$$
$ğ»$ æ˜¯ $ğ½$ åœ¨ $ğ°$ å¤„è®¡ç®—çš„*Hessian*çŸ©é˜µã€‚å½“ $\hat{J}(w)$ å–å¾—æœ€å°å€¼æ—¶ï¼Œå…¶æ¢¯åº¦åº”ä¸º0ï¼Œå³ $\nabla_{\mathbf{w}} \hat{J}(\boldsymbol{w})=\boldsymbol{H}\left(\boldsymbol{w}-\boldsymbol{w}^{*}\right)=0$.

å¼•å…¥L2æ­£åˆ™åŒ–é¡¹çš„æ¢¯åº¦ï¼Œè®¾å˜é‡ $\tilde{w}$ ä½¿å¾— $\tilde{J}(w)$ æœ€å°
$$
\nabla_{\mathbf{w}} \hat{J}(\boldsymbol{w})=      \alpha 
\tilde{w}+

\boldsymbol{H}\left(\tilde{\boldsymbol{w}}-\boldsymbol{w}^{*}\right)=0
$$
æ±‚å¾—
$$
\tilde{w} = (H + \alpha I)^{-1}Hw^*
$$
å› ä¸º ğ‘¯ æ˜¯å¯¹ç§°çŸ©é˜µï¼Œå¯åˆ†è§£ä¸º $ğ»=ğ‘„Î›ğ‘„^T$ï¼Œæ‰€ä»¥
$$
\tilde{\mathbf{w}}=Q(\Lambda+\alpha I)^{-1} \Lambda Q^{T} \mathbf{w}^{*}
$$

$$
(\Lambda+\alpha I)^{-1} \Lambda=\left[\begin{array}{cccc}\frac{\lambda_{1}}{\lambda_{1}+\alpha} & 0 & \cdots & 0 \\ 0 & \frac{\lambda_{2}}{\lambda_{2}+\alpha} & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & \frac{\lambda_{n}}{\lambda_{n}+\alpha}\end{array}\right]
$$

ä¸¾ä¾‹ï¼š$\begin{array}{r}\frac{w_{1}^{2}}{a^{2}}+\frac{w_{2}^{2}}{b^{2}}=1 , \lambda_{1}=\frac{2}{a^{2}}, \lambda_{2}=\frac{2}{b^{2}}\end{array}$

<img src="./PIC/8/8.1.png" alt="8.1" style="zoom:50%;" />

å¯è§ï¼Œæƒé‡è¡°å‡æ˜¯æ²¿ç€ğ‘¯çš„ç‰¹å¾å‘é‡çš„æ ‡å‡†æ­£äº¤åŸºæ‰€å®šä¹‰çš„è½´ç¼©æ”¾ $ğ’˜^âˆ—$ã€‚å½“åŸæŸå¤±å‡½æ•°åœ¨ç‰¹å¾å€¼å¤§çš„æ–¹å‘è¿›è¡Œä¸‹é™æ—¶ï¼Œ æ­£åˆ™åŒ–é¡¹å¯¹å…¶å½±å“è¾ƒå°ï¼›åœ¨ç‰¹å¾å€¼å°çš„æ–¹å‘è¿›è¡Œä¸‹é™æ—¶ï¼Œæ­£åˆ™åŒ–é¡¹ä¼šå¯¹å…¶è¿›è¡Œé™åˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¿è¯äº†åŸæŸå¤±å‡½æ•°æ²¿ç€æŸå¤±ä¸‹é™æœ€å¤§çš„æ–¹å‘ä¸‹é™ã€‚

**ç¨€ç–é—®é¢˜**ï¼š

1. ç‰¹å¾é€‰æ‹©ï¼š $x_i$ çš„å¤§éƒ¨åˆ†å…ƒç´ (ä¹Ÿå°±æ˜¯ç‰¹å¾)éƒ½æ˜¯å’Œæœ€ç»ˆçš„è¾“å‡º$ y_i$ æ²¡æœ‰å…³ç³»ï¼›ä½†åœ¨é¢„æµ‹æ–°çš„æ ·æœ¬æ—¶ï¼Œè¿™äº›æ²¡ç”¨çš„ä¿¡æ¯åè€Œä¼šè¢«è€ƒè™‘ï¼Œä»è€Œå¹²æ‰°äº†å¯¹æ­£ç¡® $y_i$ çš„é¢„æµ‹ã€‚ç¨€ç–è§„åˆ™åŒ–ç®—å­çš„å¼•å…¥å°±æ˜¯ä¸ºäº†å®Œæˆç‰¹å¾è‡ªåŠ¨é€‰æ‹©ï¼Œå®ƒä¼šå­¦ä¹ åœ°å»æ‰ è¿™äº›æ²¡æœ‰ä½œç”¨çš„ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯æŠŠè¿™äº›ç‰¹å¾å¯¹åº”çš„æƒé‡ç½®ä¸º0ã€‚
2. å¯è§£é‡Šæ€§ï¼šæ‚£ç—…å›å½’æ¨¡å‹ $y=w_1x_1+w_2x_2+\cdots+w_{1000}x_{1000}+b$ï¼Œ é€šè¿‡å­¦ä¹ ï¼Œå¦‚æœæœ€åå­¦ä¹ åˆ°çš„ $w^*$ å°±åªæœ‰å¾ˆå°‘çš„éé›¶å…ƒç´ ï¼Œ ä¾‹å¦‚åªæœ‰5ä¸ªéé›¶çš„ $w_i$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚£ä¸æ‚£è¿™ç§ç—…åªå’Œè¿™5ä¸ªå› ç´ æœ‰å…³ï¼Œé‚£åŒ»ç”Ÿå°±å¥½åˆ†æå¤šäº†ã€‚

### $L_1$ æ­£åˆ™åŒ– 

L1æ­£åˆ™åŒ–åˆç§°ä¸ºLassoå›å½’(Lasso Regression)ï¼Œåœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ å¾…æ­£åˆ™åŒ–å‚æ•°wçš„L1-èŒƒæ•°(å³wæ‰€æœ‰å‚æ•°ç»å¯¹ å€¼ä¹‹å’Œ)ä½œä¸ºæ­£åˆ™åŒ–é¡¹ï¼š$\Omega(w) = \|w\|_1$.

æŸå¤±å‡½æ•°ï¼š
$$
\tilde{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})=\mathrm{J}(\boldsymbol{\theta} ; \mathbf{X}, \mathbf{y})+ \alpha \|w\|_1
$$
è®¡ç®—æ¢¯åº¦ï¼š
$$
\nabla_{\mathbf{w}} \tilde{J}(\boldsymbol{w} ; \boldsymbol{X}, \boldsymbol{y})=\nabla_{\mathbf{w}} J(\boldsymbol{w} ; \boldsymbol{X}, \boldsymbol{y})+\alpha \cdot \operatorname{sign}(\boldsymbol{w})
$$

å…¶ä¸­ï¼Œsign(w)åªæ˜¯ç®€å•çš„å–wå„ä¸ªå…ƒç´ çš„æ­£è´Ÿå·ã€‚L1æ­£åˆ™åŒ–ä¸L2ä¸ å¤§ä¸€æ ·ï¼Œä¸ä¸€å®šèƒ½å¾—åˆ°$J(w;X,y)$äºŒæ¬¡è¿‘ä¼¼çš„ç›´æ¥ç®—æœ¯è§£ã€‚

**L1å‚æ•°æ­£åˆ™åŒ–åˆ†æ**

$w^*$ æ˜¯æœªæ­£åˆ™åŒ–çš„æŸå¤±å‡½æ•°ğ½å¾—åˆ°çš„æœ€å°æŸå¤±æƒé‡å‘é‡ï¼Œå³
$$
\mathbf{w}^{*}=\operatorname{argmin}_{w} J(\boldsymbol{w})
$$
åœ¨ $w^*$ å¤„å¯¹æ­£åˆ™åŒ–åçš„æŸå¤±å‡½æ•°è¿›è¡ŒäºŒæ¬¡æ³°å‹’å±•å¼€
$$
\hat{J}(\mathbf{w})=J\left(\mathbf{w}^{*}\right)+\frac{1}{2}\left(\mathbf{w}-\mathbf{w}^{*}\right)^{T} \boldsymbol{H}\left(\mathbf{w}-\mathbf{w}^{*}\right)
$$
$ğ»$æ˜¯$ğ½$åœ¨  $w^*$  å¤„è®¡ç®—çš„*Hessian*çŸ©é˜µã€‚å½“$\hat{J}(\boldsymbol{w})$ å–å¾—æœ€å°å€¼æ—¶ï¼Œå…¶æ¢¯åº¦åº” ä¸º0
$$
\nabla_{\mathbf{w}} \hat{J}(\boldsymbol{w})=   

\boldsymbol{H}\left(\boldsymbol{w}-\boldsymbol{w}^{*}\right)=0
$$
L1æ­£åˆ™é¡¹åœ¨å®Œå…¨ä¸€èˆ¬åŒ–çš„HessiançŸ©é˜µæ— æ³•å¾—åˆ°æ¸…æ™°çš„ä»£æ•°è¡¨è¾¾å¼ï¼Œ è¿›ä¸€æ­¥å‡è®¾Hessianä¸ºå¯¹è§’çŸ©é˜µï¼Œå³ $ğ‡ = diag([H_{1,1}, â‹¯ , H_{ğ‘›,n}]) $ï¼Œä¸” $H_{ğ‘–,ğ‘–} > 0$ ã€‚(å¦‚æœçº¿æ€§å›å½’é—®é¢˜ä¸­çš„æ•°æ®å·²è¢«é¢„å¤„ç†ï¼Œå»é™¤è¾“å…¥ç‰¹å¾ ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œé‚£ä¹ˆè¿™ä¸€å‡è®¾æˆç«‹)ã€‚

å¯å°†ç›®æ ‡å‡½æ•°äºŒæ¬¡è¿‘ä¼¼åˆ†è§£ä¸ºå…³äºå‚æ•°çš„æ€»å’Œ
$$
\tilde{J}(\boldsymbol{w})=J\left(\boldsymbol{w}^{*}\right)+\sum_{i}\left[\frac{1}{2} H_{i, i}\left(w_{i}-w_{i}^{*}\right)^{2}+\alpha\left|w_{i}\right|\right]
$$
æœ€å°åŒ–è¿™ä¸ªè¿‘ä¼¼æŸå¤±å‡½æ•°å¯å¾—
$$
\widetilde{w_{i}}=\operatorname{sign}\left(w_{i}^{*}\right) \max \left\{\left|w_{i}^{*}\right|-\frac{\alpha}{H_{i, i}}, 0\right\}
$$
å¾—åˆ°çš„å‚æ•° $\tilde{w}$ çš„å„ä¸ªå…ƒç´ å¯èƒ½ä¸º0ã€‚å› æ­¤ï¼Œä¸L2æ­£åˆ™åŒ–ç›¸æ¯”ï¼Œå¾—åˆ°çš„å‚æ•°æ›´åŠ ç¨€ç–ã€‚

<img src="./PIC/8/8.8.png" alt="8.8" style="zoom:50%;" />

### $L_1$å’Œ$L_2$çš„å¯¹æ¯”

- L2èŒƒæ•°æ›´æœ‰åŠ©äºè®¡ç®—ç—…æ€çš„é—®é¢˜

- L1ç›¸å¯¹äºL2èƒ½å¤Ÿäº§ç”Ÿæ›´åŠ ç¨€ç–çš„æ¨¡å‹

- ä»æ¦‚ç‡è§’åº¦è¿›è¡Œåˆ†æï¼Œå¾ˆå¤šèŒƒæ•°çº¦æŸç›¸å½“äºå¯¹å‚æ•°æ·»åŠ å…ˆ éªŒåˆ†å¸ƒï¼Œå…¶ä¸­L2èŒƒæ•°ç›¸å½“äºå‚æ•°æœä»é«˜æ–¯å…ˆéªŒåˆ†å¸ƒï¼›L1èŒƒ æ•°ç›¸å½“äºæ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒ

$$
\begin{array}{l}\underset{\boldsymbol{w}}{\operatorname{argmax}} p(\boldsymbol{w} \mid X)=\underset{\boldsymbol{w}}{\operatorname{argmax}} \frac{p(X \mid \boldsymbol{w}) p(\boldsymbol{w})}{p(X)}=\underset{\boldsymbol{w}}{\operatorname{argmax}} p(X \mid \boldsymbol{w}) p(\boldsymbol{w}) =\underset{\boldsymbol{w}}{\operatorname{argmax}}\left(\prod_{i=1}^{n} p\left(x_{i} \mid \boldsymbol{w}\right)\right) p(\boldsymbol{w}) \\ \operatorname{argmax}_{\boldsymbol{w}} L(\boldsymbol{w})=\prod_{i=1}^{n} \frac{1}{\sigma \sqrt{2 \pi}} \exp \left(\frac{\left(\boldsymbol{y}_{i}-\boldsymbol{w}^{T} \boldsymbol{x}_{i}\right)^{2}}{2 \sigma^{2}}\right) \prod_{j=1}^{d} \frac{1}{\tau \sqrt{2 \pi}} \exp \left(\frac{\left(\boldsymbol{w}_{j}\right)^{2}}{2 \tau^{2}}\right) \\ \operatorname{argmax}_{\boldsymbol{w}} L^{\prime}(\boldsymbol{w})=\ln \prod_{i=1}^{n} \frac{1}{\sigma \sqrt{2 \pi}} \exp \left(-\frac{\left(\boldsymbol{y}_{i}-\boldsymbol{w}^{T} \boldsymbol{x}_{i}\right)^{2}}{2 \sigma^{2}}\right) \prod_{j=1}^{d} \frac{1}{\tau \sqrt{2 \pi}} \exp \left(-\frac{\left(\boldsymbol{w}_{j}\right)^{2}}{2 \tau^{2}}\right) \\ =-\frac{1}{2 \sigma^{2}} \sum_{i=1}^{n}\left(\boldsymbol{y}_{i}-\boldsymbol{w}^{T} \boldsymbol{x}_{i}\right)^{2}-\frac{1}{2 \tau^{2}} \sum_{i=1}^{d}\left(\boldsymbol{w}_{j}\right)^{2}+\ldots\end{array}
$$

# ç¨€ç–è¡¨ç¤º

æ•°æ®é›†å¯è§†ä¸ºçŸ©é˜µğ‘†ï¼Œå…¶ä¸­çŸ©é˜µçš„è¡Œæ•°è¡¨ç¤ºæ ·æœ¬çš„æ•°é‡ï¼ŒçŸ©é˜µçš„åˆ—æ•°åˆ™è¡¨ç¤ºå¯¹åº”çš„ç‰¹å¾ã€‚åœ¨å¾ˆå¤šåº”ç”¨ä¸­ï¼ŒçŸ©é˜µğ‘†ä¸­å­˜åœ¨ å¾ˆå¤šé›¶å…ƒç´ ï¼Œä½†è¿™äº›é›¶å…ƒç´ å¹¶ä¸æ˜¯ä»¥æ•´åˆ—ã€æ•´è¡Œå½¢å¼å­˜åœ¨ã€‚

- å¦‚åœ¨æ–‡æ¡£åˆ†ç±»é¢†åŸŸï¼Œæˆ‘ä»¬å°†æ¯ä¸€ç¯‡æ–‡æ¡£ä½œä¸ºä¸€ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆæ•°æ®é›†å¯è¡¨ç¤ºä¸ºæ¯ä¸€è¡Œè¡¨ç¤ºä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ¯ä¸€åˆ—ä¸ºä¸€ä¸ªå­—(è¯)ï¼Œè¡Œåˆ—äº¤æ±‡å¤„å°±æ˜¯æŸå­—(è¯)åœ¨æŸæ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡ã€‚

å¦‚æœçŸ©é˜µğ‘†æ˜¯æ™®é€šçš„éç¨€ç–çŸ©é˜µï¼Œç¨€ç–è¡¨ç¤ºç›®çš„æ˜¯ä¸ºè¿™ä¸ªæ™® é€šç¨ å¯†è¡¨è¾¾çš„æ ·æœ¬ğ‘†æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„å­—å…¸ï¼Œå°†æ ·æœ¬è½¬æ¢ä¸ºç¨€ ç–è¡¨ç¤º(Sparse Representation)å½¢å¼ï¼Œä»è€Œåœ¨å­¦ä¹ è®­ç»ƒçš„ ä»»åŠ¡ä¸Šå¾—åˆ°ç®€åŒ–ï¼Œé™ä½æ¨¡å‹çš„å¤æ‚åº¦ã€‚äº¦è¢«ç§°ä½œå­—å…¸å­¦ä¹  (Dictionary Learning)

- ç¨€ç–è¡¨ç¤ºçš„æœ¬è´¨æ˜¯ä½¿ç”¨å°½å¯èƒ½å°‘çš„æ•°æ®è¡¨ç¤ºå°½å¯èƒ½å¤šçš„ç‰¹å¾ï¼Œå¹¶ä¸” åŒæ—¶ä¹Ÿèƒ½å¸¦æ¥è®¡ç®—æ•ˆç‡çš„æå‡ã€‚


### ç¨€ç–è¡¨ç¤ºå­¦ä¹ 

ç»™å®šæ•°æ®é›†ä¸º $\{x_1,x_2,\cdots,x_ğ‘›\} $å­—å…¸å­¦ä¹ å¯è¡¨ç¤ºä¸º
$$
\min _{B, \alpha_{i}} \sum_{i=1}^{m}\left\|x_{i}-B \alpha_{i}\right\|_{2}^{2}+\lambda \sum_{i=1}^{m}\left\|\alpha_{i}\right\|_{1}
$$
å…¶ä¸­$B \in R^{d \times k},\alpha_i \in R^k$ ï¼Œk ä¸ºå­—å…¸çš„è¯æ±‡é‡ï¼Œ$\alpha_i$ æ˜¯æ ·æœ¬çš„ç¨€ç–è¡¨ç¤ºã€‚ç¬¬ä¸€é¡¹ä¿è¯èƒ½å¤Ÿé€šè¿‡å­—å…¸ğµç”±ç¨€ç–è¡¨ç¤º $ğ›¼_ğ‘–$ é‡æ„æ ·æœ¬æ•°æ® $ğ‘¥_ğ‘–$ ï¼Œ ç¬¬äºŒé¡¹ä¿è¯ $ğ›¼_ğ‘–$ å°½å¯èƒ½ç¨€ç–ã€‚å­¦ä¹ ä»»åŠ¡åˆ™æ˜¯æ±‚è§£å­—å…¸ğµï¼Œä»¥åŠ $x_i$ çš„ç¨€ç–è¡¨ç¤º $\alpha_i$ ï¼Œå¯é‡‡ç”¨å˜é‡äº¤æ›¿ä¼˜åŒ–çš„ç­–ç•¥è¿›è¡Œå­¦ä¹ ã€‚
